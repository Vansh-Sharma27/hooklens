<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>HookLens — Webhook Debugger</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="/static/css/styles.css" />
  </head>
  <body class="app-root text-[#e6edf3] bg-[#0d1117]">
    <header class="app-header">
      <div class="app-header__brand">
        <button class="mobile-menu-btn" id="mobile-menu-btn" aria-label="Toggle menu">
          ≡
        </button>
        <span class="app-logo">◇</span>
        <div>
          <div class="app-title">HookLens</div>
          <div class="app-subtitle">Webhook Debugger</div>
        </div>
      </div>
      <div class="app-header__actions">
        <button class="icon-button" id="theme-toggle" aria-label="Toggle theme">
          ☾
        </button>
        <a
          class="icon-button"
          href="https://github.com/Vansh-Sharma27/hooklens"
          target="_blank"
          rel="noreferrer"
          aria-label="GitHub repository"
        >
          GitHub
        </a>
      </div>
    </header>

    <div class="app-layout">
      <aside class="endpoint-sidebar" id="endpoint-sidebar">
        <div class="sidebar-header">
          <span class="sidebar-title">My Endpoints</span>
          <button id="new-endpoint-btn" class="primary-button">+ New</button>
        </div>
        <div id="endpoint-list" class="endpoint-list">
          <div class="empty-state">Loading...</div>
        </div>
      </aside>

      <main class="app-main">
      <section class="panel endpoint-panel" aria-label="Webhook endpoint URL">
        <div class="endpoint-panel__header">
          <span class="panel-title">Your Webhook URL</span>
          <div class="endpoint-panel__actions">
            <button id="export-postman-btn" class="ghost-button">Export to Postman</button>
            <span id="connection-status" class="status-pill status-pill--connecting">
              Connecting
            </span>
          </div>
        </div>
        <div class="endpoint-panel__body">
          <input
            id="endpoint-url"
            class="endpoint-input"
            type="text"
            readonly
            value="Loading..."
            aria-label="Webhook endpoint URL"
          />
          <button id="copy-endpoint" class="primary-button">Copy</button>
        </div>
        <div class="endpoint-panel__meta">
          <span id="endpoint-meta">Creating endpoint...</span>
        </div>
      </section>

      <section class="panel response-panel" aria-label="Response configuration">
        <div class="panel-header">
          <span class="panel-title">Response Settings</span>
          <button id="toggle-response" class="ghost-button">Hide</button>
        </div>
        <div class="response-panel__content" id="response-panel-content">
          <div class="response-grid">
            <label class="field">
              <span>Status Code</span>
              <select id="response-status" class="field-input">
                <option value="200">200 OK</option>
                <option value="201">201 Created</option>
                <option value="204">204 No Content</option>
                <option value="400">400 Bad Request</option>
                <option value="401">401 Unauthorized</option>
                <option value="403">403 Forbidden</option>
                <option value="404">404 Not Found</option>
                <option value="500">500 Internal Server Error</option>
                <option value="502">502 Bad Gateway</option>
                <option value="503">503 Service Unavailable</option>
              </select>
            </label>
            <label class="field field--wide">
              <span>Response Body</span>
              <textarea
                id="response-body"
                class="field-input field-textarea"
                rows="3"
              >OK</textarea>
            </label>
            <label class="field">
              <span>Content Type</span>
              <input
                id="response-content-type"
                class="field-input"
                type="text"
                value="text/plain"
              />
            </label>
            <label class="field">
              <span>Delay (ms)</span>
              <input
                id="response-delay"
                class="field-input"
                type="number"
                min="0"
                max="30000"
                value="0"
              />
            </label>
          </div>
          <div class="response-actions">
            <div class="quick-status">
              <button class="chip" data-status="200">200 OK</button>
              <button class="chip" data-status="201">201</button>
              <button class="chip" data-status="400">400</button>
              <button class="chip" data-status="404">404</button>
              <button class="chip" data-status="500">500</button>
            </div>
            <button id="save-config" class="primary-button">Save Config</button>
          </div>
        </div>
      </section>

      <section class="panel forwarding-panel" aria-label="Request forwarding">
        <div class="panel-header">
          <span class="panel-title">Request Forwarding</span>
          <button id="toggle-forwarding" class="ghost-button">Hide</button>
        </div>
        <div class="forwarding-panel__content" id="forwarding-panel-content">
          <div class="forwarding-grid">
            <label class="field field--wide">
              <span>Forward URL</span>
              <input
                id="forward-url"
                class="field-input"
                type="text"
                placeholder="http://localhost:3000/webhook"
              />
            </label>
            <label class="field field--checkbox">
              <input
                id="auto-forward"
                type="checkbox"
              />
              <span>Auto-forward incoming requests</span>
            </label>
          </div>
          <div class="forwarding-actions">
            <button id="save-forwarding" class="primary-button">Save Forwarding Config</button>
          </div>
          <div id="forward-result" class="forward-result" style="display: none;"></div>
        </div>
      </section>

      <section class="content-grid">
        <section class="panel request-list-panel" aria-label="Captured requests">
          <div class="panel-header">
            <span class="panel-title">
              Incoming Requests (<span id="request-count">0</span>)
            </span>
            <div class="panel-actions">
              <button id="diff-mode-btn" class="ghost-button">Compare</button>
              <button id="clear-requests" class="ghost-button" disabled>
                Clear All
              </button>
            </div>
          </div>
          <div class="search-filter-bar">
            <input
              type="text"
              id="search-input"
              class="search-input"
              placeholder="Search requests..."
              aria-label="Search requests"
            />
            <div class="filter-buttons">
              <button class="filter-chip is-active" data-method="all">All</button>
              <button class="filter-chip" data-method="GET">GET</button>
              <button class="filter-chip" data-method="POST">POST</button>
              <button class="filter-chip" data-method="PUT">PUT</button>
              <button class="filter-chip" data-method="DELETE">DELETE</button>
            </div>
          </div>
          <div id="request-list" class="request-list">
            <div class="empty-state">Waiting for requests...</div>
          </div>
        </section>

        <section class="panel request-detail-panel" aria-label="Request details">
          <div class="request-detail__header">
            <button class="mobile-back-btn" id="mobile-back-btn" aria-label="Back to list">
              ← Back
            </button>
            <div id="request-title" class="request-title">
              Select a request to view details
            </div>
            <div id="request-meta" class="request-meta"></div>
          </div>
          <div class="request-detail__tabs">
            <button class="tab-button is-active" data-tab="headers">Headers</button>
            <button class="tab-button" data-tab="query">Query</button>
            <button class="tab-button" data-tab="body">Body</button>
          </div>
          <div class="request-detail__content">
            <div id="tab-headers" class="tab-panel"></div>
            <div id="tab-query" class="tab-panel hidden"></div>
            <div id="tab-body" class="tab-panel hidden"></div>
          </div>
          <div class="request-detail__actions">
            <button id="copy-headers" class="ghost-button" disabled>
              Copy Headers
            </button>
            <button id="copy-curl" class="ghost-button" disabled>
              Copy as cURL
            </button>
            <button id="copy-body" class="ghost-button" disabled>
              Copy Body
            </button>
            <button id="forward-request" class="ghost-button" disabled>
              Forward
            </button>
          </div>
          <div class="signature-panel" id="signature-panel" style="display: none;">
            <h4 class="panel-subtitle">Verify Webhook Signature</h4>
            <div class="signature-grid">
              <select id="sig-provider" class="field-input">
                <option value="stripe">Stripe</option>
                <option value="github">GitHub</option>
                <option value="slack">Slack</option>
                <option value="twilio">Twilio</option>
              </select>
              <input id="sig-secret" type="password" class="field-input" placeholder="Webhook secret" />
              <button id="verify-sig" class="primary-button">Verify</button>
            </div>
            <div id="sig-result" class="sig-result" style="display: none;"></div>
          </div>
        </section>
      </section>
    </div>

    <div class="mobile-overlay" id="mobile-overlay"></div>

    <footer class="app-footer">
      <span id="footer-status">Connecting...</span>
      <span id="footer-count">0 requests captured</span>
      <span>Made with care</span>
    </footer>

    <div id="sr-announcer" class="sr-only" role="status" aria-live="polite"></div>

    <!-- Diff Modal -->
    <div class="diff-modal" id="diff-modal" style="display: none;">
      <div class="diff-modal-content">
        <div class="diff-header">
          <span>Comparing Requests</span>
          <button id="close-diff" class="close-button">×</button>
        </div>
        <div class="diff-tabs">
          <button class="tab-button is-active" data-tab="headers">Headers</button>
          <button class="tab-button" data-tab="query">Query</button>
          <button class="tab-button" data-tab="body">Body</button>
        </div>
        <div class="diff-content" id="diff-content">
          <div class="empty-state">Select two requests to compare</div>
        </div>
      </div>
    </div>

    <!-- Export Modal -->
    <div class="export-modal" id="export-modal" style="display: none;">
      <div class="export-modal-content">
        <div class="modal-header">
          <h4>Export to Postman</h4>
          <button id="cancel-export" class="close-button">×</button>
        </div>
        <div class="modal-body">
          <label class="field">
            <span>Collection Name</span>
            <input id="export-name" class="field-input" type="text" placeholder="My Collection" />
          </label>
          <label class="field">
            <span>Base URL for Requests</span>
            <input id="export-baseurl" class="field-input" type="text" placeholder="http://localhost:3000" />
          </label>
        </div>
        <div class="modal-actions">
          <button id="export-confirm" class="primary-button">Download Collection</button>
        </div>
      </div>
    </div>

    <script type="module" src="/static/js/utils.js"></script>
    <script type="module" src="/static/js/api.js"></script>
    <script type="module" src="/static/js/websocket.js"></script>
    <script type="module" src="/static/js/ui.js"></script>
    <script type="module" src="/static/js/endpoints.js"></script>
    <script type="module" src="/static/js/search.js"></script>
    <script type="module" src="/static/js/mobile.js"></script>
    <script type="module" src="/static/js/forwarding.js"></script>
    <script type="module" src="/static/js/signatures.js"></script>
    <script type="module" src="/static/js/diff.js"></script>
    <script type="module" src="/static/js/export.js"></script>
    <script type="module" src="/static/js/app.js"></script>
  </body>
</html>
